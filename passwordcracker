#!/usr/bin/env python3
import argparse
import subprocess
import os
import sys

def build_project():
    os.makedirs("build", exist_ok=True)
    os.chdir("build")
    subprocess.run(["cmake", ".."], check=True)
    subprocess.run(["cmake", "--build", "."], check=True)
    os.chdir("..")

def run_executable(executable_name, additional_args):
    executable_path = os.path.join("build", executable_name)
    if not os.path.isfile(executable_path):
        print(f"Error: Executable '{executable_name}' not found in the build directory.")
        sys.exit(1)
    
    subprocess.run([executable_path] + additional_args, check=True)

def main():
    parser = argparse.ArgumentParser(description="Password-Cracker Utility")
    subparsers = parser.add_subparsers(dest="command")
    
    subparsers.add_parser("build", help="Build the project using cmake")
    
    run_parser = subparsers.add_parser("run", help="Run the specified executable")
    run_parser.add_argument("executable", help="Name of the executable to run")
    
    run_parser.add_argument('args', nargs=argparse.REMAINDER, help="Additional arguments for the executable")

    args = parser.parse_args()

    if args.command == "build":
        build_project()
    elif args.command == "run":
        run_executable(args.executable, args.args)
    else:
        parser.print_help()

if __name__ == "__main__":
    main()
